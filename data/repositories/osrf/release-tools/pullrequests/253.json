{"rendered": {"description": {"raw": "I wanted to test building the homebrew bottles after pull request #250 was merged, and I found that some recent changes to upstream homebrew require us to make some changes (ie. broke things).\r\n\r\nThe simplest one is that the `HOMEBREW_DEVELOPER` environment variables must be set in order to use `brew test-bot` ([brew pr 298](https://github.com/Homebrew/brew/pull/298)), fixed in 67854f0.\r\n\r\nA slightly more complicated change is that bottle metadata is now stored in a `.json` file instead of `.rb` ([brew pr 166](https://github.com/Homebrew/brew/pull/166)). This requires changing the `*.rb` to `*.json` in the dsl and changing how we identify the new hash (now using `brew ruby` instead of `grep | sed`).\r\n\r\nI tested all these changes with the [sdformat 4.1.0 PR](https://github.com/osrf/homebrew-simulation/pull/100):\r\n\r\n* [bottle builder](http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/28/) successful\r\n* [pr bottle hash updater](http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/40/) made a successful commit, but failed when trying to create a new pull request, even though one was already open\r\n\r\nIn 24f8387, we started checking the `PULL_REQUEST_URL` variable in the `_homebrew_github_commit.bash` script to see if a new PR should be created, but that variable stopped getting propagated to the PR hash updater at some point. So I've restored that variable in the dsl for the pr bottle hash updater job in 482cd6d.\r\n\r\nI tested the changes end-to-end on the [gazebo7 7.1.0 PR](https://github.com/osrf/homebrew-simulation/pull/93), and it all worked!\r\n\r\n* [bottle builder](http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/29/)\r\n* [pr bottle hash updater](http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/41/)", "markup": "markdown", "html": "<p>I wanted to test building the homebrew bottles after <a href=\"#!/osrf/release-tools/pull-requests/250/support-for-canonical-names-in-uploads-to\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #250</a> was merged, and I found that some recent changes to upstream homebrew require us to make some changes (ie. broke things).</p>\n<p>The simplest one is that the <code>HOMEBREW_DEVELOPER</code> environment variables must be set in order to use <code>brew test-bot</code> (<a data-is-external-link=\"true\" href=\"https://github.com/Homebrew/brew/pull/298\" rel=\"nofollow\">brew pr 298</a>), fixed in <a href=\"#!/osrf/release-tools/commits/67854f0\" rel=\"nofollow\" class=\"ap-connect-link\">67854f0</a>.</p>\n<p>A slightly more complicated change is that bottle metadata is now stored in a <code>.json</code> file instead of <code>.rb</code> (<a data-is-external-link=\"true\" href=\"https://github.com/Homebrew/brew/pull/166\" rel=\"nofollow\">brew pr 166</a>). This requires changing the <code>*.rb</code> to <code>*.json</code> in the dsl and changing how we identify the new hash (now using <code>brew ruby</code> instead of <code>grep | sed</code>).</p>\n<p>I tested all these changes with the <a data-is-external-link=\"true\" href=\"https://github.com/osrf/homebrew-simulation/pull/100\" rel=\"nofollow\">sdformat 4.1.0 PR</a>:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/28/\" rel=\"nofollow\">bottle builder</a> successful</li>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/40/\" rel=\"nofollow\">pr bottle hash updater</a> made a successful commit, but failed when trying to create a new pull request, even though one was already open</li>\n</ul>\n<p>In <a href=\"#!/osrf/release-tools/commits/24f8387\" rel=\"nofollow\" class=\"ap-connect-link\">24f8387</a>, we started checking the <code>PULL_REQUEST_URL</code> variable in the <code>_homebrew_github_commit.bash</code> script to see if a new PR should be created, but that variable stopped getting propagated to the PR hash updater at some point. So I've restored that variable in the dsl for the pr bottle hash updater job in <a href=\"#!/osrf/release-tools/commits/482cd6d\" rel=\"nofollow\" class=\"ap-connect-link\">482cd6d</a>.</p>\n<p>I tested the changes end-to-end on the <a data-is-external-link=\"true\" href=\"https://github.com/osrf/homebrew-simulation/pull/93\" rel=\"nofollow\">gazebo7 7.1.0 PR</a>, and it all worked!</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/29/\" rel=\"nofollow\">bottle builder</a></li>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/41/\" rel=\"nofollow\">pr bottle hash updater</a></li>\n</ul>", "type": "rendered"}, "title": {"raw": "Fix bottle building", "markup": "markdown", "html": "<p>Fix bottle building</p>", "type": "rendered"}}, "type": "pullrequest", "description": "I wanted to test building the homebrew bottles after pull request #250 was merged, and I found that some recent changes to upstream homebrew require us to make some changes (ie. broke things).\r\n\r\nThe simplest one is that the `HOMEBREW_DEVELOPER` environment variables must be set in order to use `brew test-bot` ([brew pr 298](https://github.com/Homebrew/brew/pull/298)), fixed in 67854f0.\r\n\r\nA slightly more complicated change is that bottle metadata is now stored in a `.json` file instead of `.rb` ([brew pr 166](https://github.com/Homebrew/brew/pull/166)). This requires changing the `*.rb` to `*.json` in the dsl and changing how we identify the new hash (now using `brew ruby` instead of `grep | sed`).\r\n\r\nI tested all these changes with the [sdformat 4.1.0 PR](https://github.com/osrf/homebrew-simulation/pull/100):\r\n\r\n* [bottle builder](http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/28/) successful\r\n* [pr bottle hash updater](http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/40/) made a successful commit, but failed when trying to create a new pull request, even though one was already open\r\n\r\nIn 24f8387, we started checking the `PULL_REQUEST_URL` variable in the `_homebrew_github_commit.bash` script to see if a new PR should be created, but that variable stopped getting propagated to the PR hash updater at some point. So I've restored that variable in the dsl for the pr bottle hash updater job in 482cd6d.\r\n\r\nI tested the changes end-to-end on the [gazebo7 7.1.0 PR](https://github.com/osrf/homebrew-simulation/pull/93), and it all worked!\r\n\r\n* [bottle builder](http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/29/)\r\n* [pr bottle hash updater](http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/41/)", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/pullrequests/253/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/diffstat/osrf/release-tools:b6cd8043c299%0D02e0bf1ee0ed?from_pullrequest_id=253"}, "commits": {"href": "data/repositories/osrf/release-tools/pullrequests/253/commits.json"}, "self": {"href": "data/repositories/osrf/release-tools/pullrequests/253.json"}, "comments": {"href": "data/repositories/osrf/release-tools/pullrequests/253/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/pullrequests/253/merge"}, "html": {"href": "#!/osrf/release-tools/pull-requests/253"}, "activity": {"href": "data/repositories/osrf/release-tools/pullrequests/253/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/diff/osrf/release-tools:b6cd8043c299%0D02e0bf1ee0ed?from_pullrequest_id=253"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/pullrequests/253/approve"}, "statuses": {"href": "data/repositories/osrf/release-tools/pullrequests/253/statuses_page=1.json"}}, "title": "Fix bottle building", "close_source_branch": true, "reviewers": [], "id": 253, "destination": {"commit": {"hash": "02e0bf1ee0ed", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/release-tools/commit/02e0bf1ee0ed.json"}, "html": {"href": "#!/osrf/release-tools/commits/02e0bf1ee0ed"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/release-tools.json"}, "html": {"href": "#!/osrf/release-tools"}, "avatar": {"href": "data/bytebucket.org/ravatar/{41811d3d-19d0-428e-a134-976595e72508}ts=python"}}, "type": "repository", "name": "release-tools", "full_name": "osrf/release-tools", "uuid": "{41811d3d-19d0-428e-a134-976595e72508}"}, "branch": {"name": "default"}}, "created_on": "2016-06-04T00:43:43.551298+00:00", "summary": {"raw": "I wanted to test building the homebrew bottles after pull request #250 was merged, and I found that some recent changes to upstream homebrew require us to make some changes (ie. broke things).\r\n\r\nThe simplest one is that the `HOMEBREW_DEVELOPER` environment variables must be set in order to use `brew test-bot` ([brew pr 298](https://github.com/Homebrew/brew/pull/298)), fixed in 67854f0.\r\n\r\nA slightly more complicated change is that bottle metadata is now stored in a `.json` file instead of `.rb` ([brew pr 166](https://github.com/Homebrew/brew/pull/166)). This requires changing the `*.rb` to `*.json` in the dsl and changing how we identify the new hash (now using `brew ruby` instead of `grep | sed`).\r\n\r\nI tested all these changes with the [sdformat 4.1.0 PR](https://github.com/osrf/homebrew-simulation/pull/100):\r\n\r\n* [bottle builder](http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/28/) successful\r\n* [pr bottle hash updater](http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/40/) made a successful commit, but failed when trying to create a new pull request, even though one was already open\r\n\r\nIn 24f8387, we started checking the `PULL_REQUEST_URL` variable in the `_homebrew_github_commit.bash` script to see if a new PR should be created, but that variable stopped getting propagated to the PR hash updater at some point. So I've restored that variable in the dsl for the pr bottle hash updater job in 482cd6d.\r\n\r\nI tested the changes end-to-end on the [gazebo7 7.1.0 PR](https://github.com/osrf/homebrew-simulation/pull/93), and it all worked!\r\n\r\n* [bottle builder](http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/29/)\r\n* [pr bottle hash updater](http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/41/)", "markup": "markdown", "html": "<p>I wanted to test building the homebrew bottles after <a href=\"#!/osrf/release-tools/pull-requests/250/support-for-canonical-names-in-uploads-to\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #250</a> was merged, and I found that some recent changes to upstream homebrew require us to make some changes (ie. broke things).</p>\n<p>The simplest one is that the <code>HOMEBREW_DEVELOPER</code> environment variables must be set in order to use <code>brew test-bot</code> (<a data-is-external-link=\"true\" href=\"https://github.com/Homebrew/brew/pull/298\" rel=\"nofollow\">brew pr 298</a>), fixed in <a href=\"#!/osrf/release-tools/commits/67854f0\" rel=\"nofollow\" class=\"ap-connect-link\">67854f0</a>.</p>\n<p>A slightly more complicated change is that bottle metadata is now stored in a <code>.json</code> file instead of <code>.rb</code> (<a data-is-external-link=\"true\" href=\"https://github.com/Homebrew/brew/pull/166\" rel=\"nofollow\">brew pr 166</a>). This requires changing the <code>*.rb</code> to <code>*.json</code> in the dsl and changing how we identify the new hash (now using <code>brew ruby</code> instead of <code>grep | sed</code>).</p>\n<p>I tested all these changes with the <a data-is-external-link=\"true\" href=\"https://github.com/osrf/homebrew-simulation/pull/100\" rel=\"nofollow\">sdformat 4.1.0 PR</a>:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/28/\" rel=\"nofollow\">bottle builder</a> successful</li>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/40/\" rel=\"nofollow\">pr bottle hash updater</a> made a successful commit, but failed when trying to create a new pull request, even though one was already open</li>\n</ul>\n<p>In <a href=\"#!/osrf/release-tools/commits/24f8387\" rel=\"nofollow\" class=\"ap-connect-link\">24f8387</a>, we started checking the <code>PULL_REQUEST_URL</code> variable in the <code>_homebrew_github_commit.bash</code> script to see if a new PR should be created, but that variable stopped getting propagated to the PR hash updater at some point. So I've restored that variable in the dsl for the pr bottle hash updater job in <a href=\"#!/osrf/release-tools/commits/482cd6d\" rel=\"nofollow\" class=\"ap-connect-link\">482cd6d</a>.</p>\n<p>I tested the changes end-to-end on the <a data-is-external-link=\"true\" href=\"https://github.com/osrf/homebrew-simulation/pull/93\" rel=\"nofollow\">gazebo7 7.1.0 PR</a>, and it all worked!</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_bottle_builder/29/\" rel=\"nofollow\">bottle builder</a></li>\n<li><a data-is-external-link=\"true\" href=\"http://build.osrfoundation.org/job/generic-release-homebrew_pr_bottle_hash_updater/41/\" rel=\"nofollow\">pr bottle hash updater</a></li>\n</ul>", "type": "rendered"}, "source": {"commit": {"hash": "c60accdc5bc7", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/release-tools/commit/c60accdc5bc7.json"}, "html": {"href": "#!/osrf/release-tools/commits/c60accdc5bc7"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/release-tools.json"}, "html": {"href": "#!/osrf/release-tools"}, "avatar": {"href": "data/bytebucket.org/ravatar/{41811d3d-19d0-428e-a134-976595e72508}ts=python"}}, "type": "repository", "name": "release-tools", "full_name": "osrf/release-tools", "uuid": "{41811d3d-19d0-428e-a134-976595e72508}"}, "branch": {"name": "homebrew_testbot_env"}}, "comment_count": 5, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2016-06-06T22:47:54.348839+00:00", "type": "participant", "approved": true, "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}}, {"role": "PARTICIPANT", "participated_on": "2016-06-06T22:46:34.556078+00:00", "type": "participant", "approved": false, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}], "reason": "", "updated_on": "2016-06-06T22:49:55.251408+00:00", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "merge_commit": {"hash": "b6cd8043c299", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/release-tools/commit/b6cd8043c299.json"}, "html": {"href": "#!/osrf/release-tools/commits/b6cd8043c299"}}}, "closed_by": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}