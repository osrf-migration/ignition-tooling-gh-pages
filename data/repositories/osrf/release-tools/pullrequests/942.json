{"rendered": {"description": {"raw": "Current code only uploaded source packages \\(.dsc\\) to the repository when the package being uploaded does not have any versions. The problem with this is that new versions of the same  package does not get the source package updated as well.\r\n\r\nThese changes try to detect new versions and upload them.\r\n\r\nOnly tried it for an already existing version:\r\n\r\n![](https://build.osrfoundation.org/buildStatus/icon?job=repository_uploader_packages&build=2880)\r\n[https://build.osrfoundation.org/view/All/job/repository\\_uploader\\_packages/2880/](https://build.osrfoundation.org/view/All/job/repository_uploader_packages/2880/))\r\n\r\n\u200c\r\n\r\n```\r\n+ for pkg in '`ls $pkgs_path/*.dsc`'\r\n+ pkg_name_clean=lark-parser_0.7.8-1osrf~focal.dsc\r\n+ pkg_name=lark-parser\r\n+ pkg_version=0.7.8-1osrf~focal.dsc\r\n+ pkg_version=0.7.8-1osrf~focal\r\n+ dsc_package_exists_and_equal_or_greater lark-parser 0.7.8-1osrf~focal\r\n+ local pkg=lark-parser new_version=0.7.8-1osrf~focal\r\n++ sudo GNUPGHOME=/var/lib/jenkins/.gnupg/ reprepro -T dsc ls lark-parser\r\n++ grep focal\r\n+ current_dsc_info='lark-parser |                  0.7.8-1osrf~focal |  focal | source'\r\n+ [[ -z lark-parser |                  0.7.8-1osrf~focal |  focal | source ]]\r\n++ awk '{ print $3 }'\r\n+ current_version=0.7.8-1osrf~focal\r\n++ dpkg --compare-versions 0.7.8-1osrf~focal lt 0.7.8-1osrf~focal\r\n+ return 0\r\n+ echo 'Source package for /var/lib/jenkins/workspace/repository_uploader_packages/pkgs/lark-parser_0.7.8-1osrf~focal.dsc already exists in the repo and it'\\''s greater or equal than current version'\r\n```\r\n\r\n\u200c", "markup": "markdown", "html": "<p>Current code only uploaded source packages (.dsc) to the repository when the package being uploaded does not have any versions. The problem with this is that new versions of the same  package does not get the source package updated as well.</p>\n<p>These changes try to detect new versions and upload them.</p>\n<p>Only tried it for an already existing version:</p>\n<p><img alt=\"\" src=\"https://build.osrfoundation.org/buildStatus/icon?job=repository_uploader_packages&amp;build=2880\" />\n<a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/view/All/job/repository_uploader_packages/2880/\" rel=\"nofollow\">https://build.osrfoundation.org/view/All/job/repository_uploader_packages/2880/</a>)</p>\n<p>\u200c</p>\n<div class=\"codehilite\"><pre><span></span>+ for pkg in &#39;`ls $pkgs_path/*.dsc`&#39;\n+ pkg_name_clean=lark-parser_0.7.8-1osrf~focal.dsc\n+ pkg_name=lark-parser\n+ pkg_version=0.7.8-1osrf~focal.dsc\n+ pkg_version=0.7.8-1osrf~focal\n+ dsc_package_exists_and_equal_or_greater lark-parser 0.7.8-1osrf~focal\n+ local pkg=lark-parser new_version=0.7.8-1osrf~focal\n++ sudo GNUPGHOME=/var/lib/jenkins/.gnupg/ reprepro -T dsc ls lark-parser\n++ grep focal\n+ current_dsc_info=&#39;lark-parser |                  0.7.8-1osrf~focal |  focal | source&#39;\n+ [[ -z lark-parser |                  0.7.8-1osrf~focal |  focal | source ]]\n++ awk &#39;{ print $3 }&#39;\n+ current_version=0.7.8-1osrf~focal\n++ dpkg --compare-versions 0.7.8-1osrf~focal lt 0.7.8-1osrf~focal\n+ return 0\n+ echo &#39;Source package for /var/lib/jenkins/workspace/repository_uploader_packages/pkgs/lark-parser_0.7.8-1osrf~focal.dsc already exists in the repo and it&#39;\\&#39;&#39;s greater or equal than current version&#39;\n</pre></div>\n\n\n<p>\u200c</p>", "type": "rendered"}, "title": {"raw": "Fix the upload a source package when new versions are uploaded", "markup": "markdown", "html": "<p>Fix the upload a source package when new versions are uploaded</p>", "type": "rendered"}}, "type": "pullrequest", "description": "Current code only uploaded source packages \\(.dsc\\) to the repository when the package being uploaded does not have any versions. The problem with this is that new versions of the same  package does not get the source package updated as well.\r\n\r\nThese changes try to detect new versions and upload them.\r\n\r\nOnly tried it for an already existing version:\r\n\r\n![](https://build.osrfoundation.org/buildStatus/icon?job=repository_uploader_packages&build=2880)\r\n[https://build.osrfoundation.org/view/All/job/repository\\_uploader\\_packages/2880/](https://build.osrfoundation.org/view/All/job/repository_uploader_packages/2880/))\r\n\r\n\u200c\r\n\r\n```\r\n+ for pkg in '`ls $pkgs_path/*.dsc`'\r\n+ pkg_name_clean=lark-parser_0.7.8-1osrf~focal.dsc\r\n+ pkg_name=lark-parser\r\n+ pkg_version=0.7.8-1osrf~focal.dsc\r\n+ pkg_version=0.7.8-1osrf~focal\r\n+ dsc_package_exists_and_equal_or_greater lark-parser 0.7.8-1osrf~focal\r\n+ local pkg=lark-parser new_version=0.7.8-1osrf~focal\r\n++ sudo GNUPGHOME=/var/lib/jenkins/.gnupg/ reprepro -T dsc ls lark-parser\r\n++ grep focal\r\n+ current_dsc_info='lark-parser |                  0.7.8-1osrf~focal |  focal | source'\r\n+ [[ -z lark-parser |                  0.7.8-1osrf~focal |  focal | source ]]\r\n++ awk '{ print $3 }'\r\n+ current_version=0.7.8-1osrf~focal\r\n++ dpkg --compare-versions 0.7.8-1osrf~focal lt 0.7.8-1osrf~focal\r\n+ return 0\r\n+ echo 'Source package for /var/lib/jenkins/workspace/repository_uploader_packages/pkgs/lark-parser_0.7.8-1osrf~focal.dsc already exists in the repo and it'\\''s greater or equal than current version'\r\n```\r\n\r\n\u200c", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/pullrequests/942/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/diffstat/osrf/release-tools:96722727273c%0D052e3bb6281a?from_pullrequest_id=942"}, "commits": {"href": "data/repositories/osrf/release-tools/pullrequests/942/commits.json"}, "self": {"href": "data/repositories/osrf/release-tools/pullrequests/942.json"}, "comments": {"href": "data/repositories/osrf/release-tools/pullrequests/942/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/pullrequests/942/merge"}, "html": {"href": "#!/osrf/release-tools/pull-requests/942"}, "activity": {"href": "data/repositories/osrf/release-tools/pullrequests/942/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/diff/osrf/release-tools:96722727273c%0D052e3bb6281a?from_pullrequest_id=942"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/pullrequests/942/approve"}, "statuses": {"href": "data/repositories/osrf/release-tools/pullrequests/942/statuses_page=1.json"}}, "title": "Fix the upload a source package when new versions are uploaded", "close_source_branch": true, "reviewers": [], "id": 942, "destination": {"commit": {"hash": "052e3bb6281a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/release-tools/commit/052e3bb6281a.json"}, "html": {"href": "#!/osrf/release-tools/commits/052e3bb6281a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/release-tools.json"}, "html": {"href": "#!/osrf/release-tools"}, "avatar": {"href": "data/bytebucket.org/ravatar/{41811d3d-19d0-428e-a134-976595e72508}ts=python"}}, "type": "repository", "name": "release-tools", "full_name": "osrf/release-tools", "uuid": "{41811d3d-19d0-428e-a134-976595e72508}"}, "branch": {"name": "default"}}, "created_on": "2020-01-10T18:54:47.256173+00:00", "summary": {"raw": "Current code only uploaded source packages \\(.dsc\\) to the repository when the package being uploaded does not have any versions. The problem with this is that new versions of the same  package does not get the source package updated as well.\r\n\r\nThese changes try to detect new versions and upload them.\r\n\r\nOnly tried it for an already existing version:\r\n\r\n![](https://build.osrfoundation.org/buildStatus/icon?job=repository_uploader_packages&build=2880)\r\n[https://build.osrfoundation.org/view/All/job/repository\\_uploader\\_packages/2880/](https://build.osrfoundation.org/view/All/job/repository_uploader_packages/2880/))\r\n\r\n\u200c\r\n\r\n```\r\n+ for pkg in '`ls $pkgs_path/*.dsc`'\r\n+ pkg_name_clean=lark-parser_0.7.8-1osrf~focal.dsc\r\n+ pkg_name=lark-parser\r\n+ pkg_version=0.7.8-1osrf~focal.dsc\r\n+ pkg_version=0.7.8-1osrf~focal\r\n+ dsc_package_exists_and_equal_or_greater lark-parser 0.7.8-1osrf~focal\r\n+ local pkg=lark-parser new_version=0.7.8-1osrf~focal\r\n++ sudo GNUPGHOME=/var/lib/jenkins/.gnupg/ reprepro -T dsc ls lark-parser\r\n++ grep focal\r\n+ current_dsc_info='lark-parser |                  0.7.8-1osrf~focal |  focal | source'\r\n+ [[ -z lark-parser |                  0.7.8-1osrf~focal |  focal | source ]]\r\n++ awk '{ print $3 }'\r\n+ current_version=0.7.8-1osrf~focal\r\n++ dpkg --compare-versions 0.7.8-1osrf~focal lt 0.7.8-1osrf~focal\r\n+ return 0\r\n+ echo 'Source package for /var/lib/jenkins/workspace/repository_uploader_packages/pkgs/lark-parser_0.7.8-1osrf~focal.dsc already exists in the repo and it'\\''s greater or equal than current version'\r\n```\r\n\r\n\u200c", "markup": "markdown", "html": "<p>Current code only uploaded source packages (.dsc) to the repository when the package being uploaded does not have any versions. The problem with this is that new versions of the same  package does not get the source package updated as well.</p>\n<p>These changes try to detect new versions and upload them.</p>\n<p>Only tried it for an already existing version:</p>\n<p><img alt=\"\" src=\"https://build.osrfoundation.org/buildStatus/icon?job=repository_uploader_packages&amp;build=2880\" />\n<a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/view/All/job/repository_uploader_packages/2880/\" rel=\"nofollow\">https://build.osrfoundation.org/view/All/job/repository_uploader_packages/2880/</a>)</p>\n<p>\u200c</p>\n<div class=\"codehilite\"><pre><span></span>+ for pkg in &#39;`ls $pkgs_path/*.dsc`&#39;\n+ pkg_name_clean=lark-parser_0.7.8-1osrf~focal.dsc\n+ pkg_name=lark-parser\n+ pkg_version=0.7.8-1osrf~focal.dsc\n+ pkg_version=0.7.8-1osrf~focal\n+ dsc_package_exists_and_equal_or_greater lark-parser 0.7.8-1osrf~focal\n+ local pkg=lark-parser new_version=0.7.8-1osrf~focal\n++ sudo GNUPGHOME=/var/lib/jenkins/.gnupg/ reprepro -T dsc ls lark-parser\n++ grep focal\n+ current_dsc_info=&#39;lark-parser |                  0.7.8-1osrf~focal |  focal | source&#39;\n+ [[ -z lark-parser |                  0.7.8-1osrf~focal |  focal | source ]]\n++ awk &#39;{ print $3 }&#39;\n+ current_version=0.7.8-1osrf~focal\n++ dpkg --compare-versions 0.7.8-1osrf~focal lt 0.7.8-1osrf~focal\n+ return 0\n+ echo &#39;Source package for /var/lib/jenkins/workspace/repository_uploader_packages/pkgs/lark-parser_0.7.8-1osrf~focal.dsc already exists in the repo and it&#39;\\&#39;&#39;s greater or equal than current version&#39;\n</pre></div>\n\n\n<p>\u200c</p>", "type": "rendered"}, "source": {"commit": {"hash": "96722727273c", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/release-tools/commit/96722727273c.json"}, "html": {"href": "#!/osrf/release-tools/commits/96722727273c"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/release-tools.json"}, "html": {"href": "#!/osrf/release-tools"}, "avatar": {"href": "data/bytebucket.org/ravatar/{41811d3d-19d0-428e-a134-976595e72508}ts=python"}}, "type": "repository", "name": "release-tools", "full_name": "osrf/release-tools", "uuid": "{41811d3d-19d0-428e-a134-976595e72508}"}, "branch": {"name": "support_src_xz"}}, "comment_count": 1, "state": "OPEN", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2020-03-20T01:24:01.687737+00:00", "type": "participant", "approved": false, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}], "reason": "", "updated_on": "2020-03-20T01:24:01.687737+00:00", "author": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "merge_commit": null, "closed_by": null}