{"links": {"self": {"href": "data/repositories/osrf/release-tools/issues/109/comments/48009361.json"}, "html": {"href": "#!/osrf/release-tools/issues/109#comment-48009361"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/release-tools/issues/109.json"}}, "type": "issue", "id": 109, "repository": {"links": {"self": {"href": "data/repositories/osrf/release-tools.json"}, "html": {"href": "#!/osrf/release-tools"}, "avatar": {"href": "data/bytebucket.org/ravatar/{41811d3d-19d0-428e-a134-976595e72508}ts=python"}}, "type": "repository", "name": "release-tools", "full_name": "osrf/release-tools", "uuid": "{41811d3d-19d0-428e-a134-976595e72508}"}, "title": "Use brew bottle more and host bottles at bintray"}, "content": {"raw": "I've looked into a more standard approach to updating the bottle hashes in the formula using `brew bottle --merge --write x.bottle.json` with arguments `--no-commit --keep-old`, but there is a challenge since we don't upload all our bottles to the same URL (ie. gazebosim.org/distributions/gazebo/releases and gazebosim.org/distributions/sdformat/releases differ). The challenge is that the `root_url` must already be specified in the json file, which means that the `--root_url=http://gazebosim.org/distributions/x/releases` argument must be passed to `brew test-bot` when the bottles are created. This is fine if a pull request only modifies different versions of the same formula (like `gazebo7`, `gazebo8` or `gazebo9`), but if it modifies different formula (like `ignition-msgs1`, `ignition-transport4`, and `gazebo9` in [osrf/homebrew-simulation#492](https://github.com/osrf/homebrew-simulation/pull/492)) then the root URL's won't match.\n\nWe could consider changing out hosting pattern for homebrew bottles to put them all in a single folder.", "markup": "markdown", "html": "<p>I've looked into a more standard approach to updating the bottle hashes in the formula using <code>brew bottle --merge --write x.bottle.json</code> with arguments <code>--no-commit --keep-old</code>, but there is a challenge since we don't upload all our bottles to the same URL (ie. <a href=\"http://gazebosim.org/distributions/gazebo/releases\" rel=\"nofollow\" class=\"ap-connect-link\">gazebosim.org/distributions/gazebo/releases</a> and <a href=\"http://gazebosim.org/distributions/sdformat/releases\" rel=\"nofollow\" class=\"ap-connect-link\">gazebosim.org/distributions/sdformat/releases</a> differ). The challenge is that the <code>root_url</code> must already be specified in the json file, which means that the <code>--root_url=http://gazebosim.org/distributions/x/releases</code> argument must be passed to <code>brew test-bot</code> when the bottles are created. This is fine if a pull request only modifies different versions of the same formula (like <code>gazebo7</code>, <code>gazebo8</code> or <code>gazebo9</code>), but if it modifies different formula (like <code>ignition-msgs1</code>, <code>ignition-transport4</code>, and <code>gazebo9</code> in <a data-is-external-link=\"true\" href=\"https://github.com/osrf/homebrew-simulation/pull/492\" rel=\"nofollow\">osrf/homebrew-simulation#492</a>) then the root URL's won't match.</p>\n<p>We could consider changing out hosting pattern for homebrew bottles to put them all in a single folder.</p>", "type": "rendered"}, "created_on": "2018-09-25T23:00:06.204100+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": null, "type": "issue_comment", "id": 48009361}