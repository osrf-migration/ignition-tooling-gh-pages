{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/release-tools.json"}, "html": {"href": "#!/osrf/release-tools"}, "avatar": {"href": "data/bytebucket.org/ravatar/{41811d3d-19d0-428e-a134-976595e72508}ts=python"}}, "type": "repository", "name": "release-tools", "full_name": "osrf/release-tools", "uuid": "{41811d3d-19d0-428e-a134-976595e72508}"}, "links": {"attachments": {"href": "data/repositories/osrf/release-tools/issues/115/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/release-tools/issues/115.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/issues/115/watch"}, "comments": {"href": "data/repositories/osrf/release-tools/issues/115/comments_page=1.json"}, "html": {"href": "#!/osrf/release-tools/issues/115/sdformat_major_version-not-set-in-gazebo"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/release-tools/issues/115/vote"}}, "reporter": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "title": "SDFORMAT_MAJOR_VERSION not set in gazebo multi-any jobs", "component": null, "votes": 0, "watches": 1, "content": {"raw": "The [gazebo-ci-pr_any+sdformat_any+ign_any-xenial-amd64-gpu-nvidia](https://build.osrfoundation.org/job/gazebo-ci-pr_any+sdformat_any+ign_any-xenial-amd64-gpu-nvidia/) job builds gazebo with sdformat and some ignition packages from source. @iche033 recently tried building a branch of `gazebo7` it with a custom branch of  `sdf4` and `ign-math2`, but it failed while trying to install dependencies.\r\n\r\n* https://build.osrfoundation.org/job/gazebo-ci-pr_any+sdformat_any+ign_any-xenial-amd64-gpu-nvidia/5/\r\n\r\nI believe it failed because the `SDFORMAT_MAJOR_VERSION` variable wasn't set when [boilerplate_prepare.sh is called in gazebo-base-default.bash](#!/osrf/release-tools/src/b4b8050b6542fbedc2d1beb0b6e4125b0f299a1b/jenkins-scripts/docker/lib/gazebo-base-default.bash?at=default&fileviewer=file-view-default#gazebo-base-default.bash-22), so it defaulted to major version 5. I made a test branch with a different default value for @iche033 to get his test running, but it would be nice if we could handle this better. Maybe we need an extra if block where we check if sdformat is being built and call an sdformat_version_hook if so.", "markup": "markdown", "html": "<p>The <a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/gazebo-ci-pr_any+sdformat_any+ign_any-xenial-amd64-gpu-nvidia/\" rel=\"nofollow\">gazebo-ci-pr_any+sdformat_any+ign_any-xenial-amd64-gpu-nvidia</a> job builds gazebo with sdformat and some ignition packages from source. @iche033 recently tried building a branch of <code>gazebo7</code> it with a custom branch of  <code>sdf4</code> and <code>ign-math2</code>, but it failed while trying to install dependencies.</p>\n<ul>\n<li><a href=\"https://build.osrfoundation.org/job/gazebo-ci-pr_any+sdformat_any+ign_any-xenial-amd64-gpu-nvidia/5/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/gazebo-ci-pr_any+sdformat_any+ign_any-xenial-amd64-gpu-nvidia/5/</a></li>\n</ul>\n<p>I believe it failed because the <code>SDFORMAT_MAJOR_VERSION</code> variable wasn't set when <a data-is-external-link=\"true\" href=\"#!/osrf/release-tools/src/b4b8050b6542fbedc2d1beb0b6e4125b0f299a1b/jenkins-scripts/docker/lib/gazebo-base-default.bash?at=default&amp;fileviewer=file-view-default#gazebo-base-default.bash-22\" rel=\"nofollow\">boilerplate_prepare.sh is called in gazebo-base-default.bash</a>, so it defaulted to major version 5. I made a test branch with a different default value for @iche033 to get his test running, but it would be nice if we could handle this better. Maybe we need an extra if block where we check if sdformat is being built and call an sdformat_version_hook if so.</p>", "type": "rendered"}, "assignee": null, "state": "new", "version": null, "edited_on": null, "created_on": "2017-09-07T23:18:06.204920+00:00", "milestone": null, "updated_on": "2017-09-29T17:02:21.372860+00:00", "type": "issue", "id": 115}